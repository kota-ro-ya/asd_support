# AI バリエーション機能の UI 操作ガイド

## 🎯 問題：「チェックボックスがどこにあるかわからない」

このガイドでは、AI バリエーション機能を有効にする場所を**画像付き**で説明します。

---

## 📍 手順 1：イベント選択画面を開く

### どこにあるか

```
アプリ起動
  ↓
ニックネーム入力（初回のみ）
  ↓
モード選択画面
  ↓
「子供向けモード」を選択
  ↓
【★ここ★】イベント選択画面
```

### 画面の見た目

```
┌─────────────────────────────────────────┐
│ 🌟 ○○さん、今日はどこへ行こう？          │
│                     [🏠 モード選択に戻る] │
├─────────────────────────────────────────┤
│                                         │
│ 📊 これまでの進捗を見る ▼               │
│                                         │
├─────────────────────────────────────────┤
│                                         │
│ 🎯 学びたい場面を選んでね                │
│                                         │
│ ┌──────────────┐  ┌──────────────┐    │
│ │☐ 🤖AIバリエーション│  │☐ 🔄毎回新しく生成│    │ ← ★ここをチェック★
│ └──────────────┘  └──────────────┘    │
│                                         │
│ ✨ AIバリエーションモード：...          │
│                                         │
├─────────────────────────────────────────┤
│ ┌──────────┐  ┌──────────┐            │
│ │ トイレ   │  │ 床屋    │            │
│ │          │  │          │            │
│ └──────────┘  └──────────┘            │
│ ┌──────────┐  ┌──────────┐            │
│ │ 病院     │  │ 公園    │            │
│ │          │  │          │            │
│ └──────────┘  └──────────┘            │
│ ┌──────────┐                          │
│ │ 身支度   │                          │
│ │          │                          │
│ └──────────┘                          │
└─────────────────────────────────────────┘
```

---

## ✅ 手順 2：チェックボックスをオンにする

### 操作方法

#### ステップ 2-1：左側のチェックボックスをクリック

```
☐ 🤖 AIバリエーション  → クリック → ☑ 🤖 AIバリエーション
```

**これをオンにすると、右側にもう 1 つチェックボックスが表示されます**

#### ステップ 2-2：右側のチェックボックスをクリック

```
☐ 🔄 毎回新しく生成  → クリック → ☑ 🔄 毎回新しく生成
```

### 正しい設定状態

```
☑ 🤖 AIバリエーション  ☑ 🔄 毎回新しく生成
```

**両方にチェックが入っている状態が正解です！**

---

## 🎮 手順 3：イベントを選択

```
┌──────────┐
│ 床屋     │  ← クリック
│          │
└──────────┘
```

---

## 🔍 確認方法：正しく設定できているか？

### チェック 1：説明文が表示されているか

両方のチェックボックスをオンにすると、以下のメッセージが表示されます：

```
✨ AIバリエーションモード：場面1、場面2ともに毎回完全に異なる内容が生成されます！
```

このメッセージが表示されていれば**正しく設定されています**。

### チェック 2：生成に時間がかかるか

床屋を選択した後、場面 1 が表示されるまでに**2-5 秒程度**待たされます。

```
⏳ AIが新しいシナリオを生成中...
```

このスピナー（読み込みマーク）が表示されれば、AI が動いている証拠です。

---

## ⚠️ よくある問題と解決方法

### 問題 1：チェックボックスが見当たらない

**原因**：画面をスクロールしていない

**解決策**：

1. イベント選択画面で**下にスクロール**してください
2. 「📊 これまでの進捗を見る」の**下**にチェックボックスがあります

### 問題 2：「🔄 毎回新しく生成」が表示されない

**原因**：「🤖 AI バリエーション」がオフになっている

**解決策**：

1. まず「🤖 AI バリエーション」をクリックしてオンにしてください
2. すると右側に「🔄 毎回新しく生成」が**自動的に表示**されます

### 問題 3：チェックを入れても場面が同じ

**原因**：

- チェックを入れる前に床屋を始めてしまった
- ブラウザのキャッシュが残っている

**解決策**：

1. 「🏠 イベント選択に戻る」ボタンをクリック
2. チェックボックスが**両方オン**になっているか確認
3. もう一度床屋を選択

---

## 🎯 正しい操作フロー（まとめ）

```
1. イベント選択画面を開く
   ↓
2. 「🤖 AIバリエーション」をオン（左側）
   ↓
3. 「🔄 毎回新しく生成」をオン（右側）← これが重要！
   ↓
4. 説明文を確認：
   「✨ AIバリエーションモード：場面1、場面2ともに毎回完全に異なる内容が生成されます！」
   ↓
5. 床屋を選択
   ↓
6. 2-5秒待つ（AIが生成中）
   ↓
7. 場面1が表示される（前回と異なる内容のはず）
   ↓
8. 最後まで進める
   ↓
9. 「🏠 イベント選択に戻る」
   ↓
10. もう一度床屋を選択
   ↓
11. また違う場面1が表示される！✨
```

---

## 🖼️ 実際の画面イメージ

### 設定前（両方オフ）

```
学びたい場面を選んでね

☐ 🤖 AIバリエーション

（説明文なし）

[トイレ] [床屋] [病院] [公園] [身支度]
```

### 設定途中（左のみオン）

```
学びたい場面を選んでね

☑ 🤖 AIバリエーション  ☐ 🔄 毎回新しく生成

✨ AIバリエーションモード：一度生成された内容は24時間キャッシュされます

[トイレ] [床屋] [病院] [公園] [身支度]
```

### 設定完了（両方オン）⭐

```
学びたい場面を選んでね

☑ 🤖 AIバリエーション  ☑ 🔄 毎回新しく生成

✨ AIバリエーションモード：場面1、場面2ともに毎回完全に異なる内容が生成されます！

[トイレ] [床屋] [病院] [公園] [身支度]
```

---

## 📱 動作確認チェックリスト

プレイする前に、以下を確認してください：

- [ ] イベント選択画面を開いている
- [ ] 「🤖 AI バリエーション」にチェックが入っている
- [ ] 「🔄 毎回新しく生成」にチェックが入っている
- [ ] 説明文が「場面 1、場面 2 ともに毎回完全に異なる内容が生成されます！」になっている
- [ ] この状態でイベントを選択する

すべてにチェックが入っていれば、**毎回異なる内容**が生成されます！

---

## 🆘 それでも解決しない場合

### デバッグ手順

1. **ブラウザを完全に閉じる**
2. **もう一度アプリを起動**
   ```bash
   streamlit run app/main.py
   ```
3. **新しいブラウザタブで開く**
4. **最初から手順を実行**

### 確認事項

- `.env` ファイルに `OPENAI_API_KEY` が設定されているか
- インターネット接続があるか
- ブラウザのコンソールにエラーが出ていないか（F12 で確認）

---

## 💡 補足情報

### なぜ 2 つのチェックボックスがあるのか？

1. **🤖 AI バリエーション**

   - AI 機能自体の ON/OFF
   - これがオフだと固定テンプレート（常に同じ内容）

2. **🔄 毎回新しく生成**
   - キャッシュを使うかどうか
   - オフだと 24 時間は同じ内容が表示される
   - **オンだと毎回新しい内容が生成される**

### 推奨設定

**初めて使う場合・多様性を求める場合**

```
☑ 🤖 AIバリエーション
☑ 🔄 毎回新しく生成
```

**コストを抑えたい場合**

```
☑ 🤖 AIバリエーション
☐ 🔄 毎回新しく生成
```

**いつもの内容で練習したい場合**

```
☐ 🤖 AIバリエーション
```

---

**最終更新**: 2025 年 11 月 1 日  
**バージョン**: 1.2
